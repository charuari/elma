<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Elma: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Elma
   </div>
   <div id="projectbrief">An event loop manager for embedded systems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part --><!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Enumerations</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Elma Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Elma is an event loop and process manager for embedded and reactive systems. It keeps track of processes, finite state machines, events, and communication channels, executing them at specified frequencies. Currently, processes talk to each other via events, this repository contains methods which describes how Json messages will be send back and forth between processes using TCP/IP protocol.</p>
<h1>Installation </h1>
<p>The source code for Elma_TCP <a href="https://github.com/charuari/elma_TCP">is on Github</a>.</p>
<h1>From Dockerhub </h1>
<p>To get started, you will need a C++ build environment to compile.</p><ul>
<li>git clone <a href="https://github.com/charuari/elma_TCP.git">https://github.com/charuari/elma_TCP.git</a></li>
<li>docker run -v $PWD:/source -it klavins/elma:latest bash</li>
<li>make</li>
</ul>
<h1>Execution </h1>
<h2>Example 1 </h2>
<ul>
<li>examples/bin/test_pingserver &amp;</li>
<li>examples/bin/test_pingclient</li>
<li>ps waux</li>
</ul>
<h2>Example 2 </h2>
<ul>
<li>example/bin/test_server &amp;</li>
<li>example/bin/test_client</li>
<li>ps waux</li>
</ul>
<h1>Design Process </h1>
<p>To make Elma processes communication via TCP/IP, the first step I decided to do is to write a C++ library for TCP/IP server and client, so that instances of them can be used inside elma process derived class. The library I used is C socket library and many resources had things written in C. Hence, writing one in C++ felt mandatory in my case. The send and receive features of server and client involves byte packets and initially, I had designed them for only strings and tested it with basic server client chat . Upon success, I had to tweek a little to make it suitable for json messages. Now, TCP/IP server client could send back and forth json messages.</p>
<p>The goal of this project is to use this in Elma and I had decided to build two examples for it.</p><ol type="1">
<li>Simple client server ping</li>
<li>Temperature server</li>
</ol>
<h1>Description </h1>
<h2>Simple client server ping </h2>
<p>This was experimented to see how to integrate the so far stand-a-lone TCP/IP into Elma.</p>
<p>Server and client were derived from abstract base class of Elma process and the update of client process will emit the json message(here, it's just an hello) which is send to be send to server. This event will be watched in the init method with appropriate handler.</p>
<p>Similarly, the update of server process will receive the message from client and send back the current time and date as an acknowldegement of the established communication.</p>
<p>Just printing the messages from server and client terminal help us to confirm the communication.</p>
<h2>Temperature server </h2>
<p>Server and client are derived from Elma process base class. A helper class is used to generate random temperature and geographic co-ordinates which serves as data to be sent by client to server. This data will be sent from client process update method to server and it is received in the server process update method and the server sends back the count of the data received so far.</p>
<p>The random data generator is set with srand(0), for the values to be determinant so that it can be tested in the server side if same data is received. Also, the number of updates of server process is tested for the number of acknowledgements sent back to client.</p>
<p>Print statements from server and client terminals are used to confirm communication.</p>
<h1>Files </h1>
<h2>C++ library for TCP/IP: </h2>
<ul>
<li><a class="el" href="tcp__server_8h_source.html">tcp_server.h</a></li>
<li><a class="el" href="tcp__client_8h_source.html">tcp_client.h</a></li>
<li><a class="el" href="tcp__server_8cc_source.html">tcp_server.cc</a></li>
<li><a class="el" href="tcp__client_8cc_source.html">tcp_client.cc</a></li>
</ul>
<h2>Simple Client Server ping </h2>
<ul>
<li><a class="el" href="server__ping_8h_source.html">server_ping.h</a></li>
<li><a class="el" href="client__ping_8h_source.html">client_ping.h</a></li>
<li><a class="el" href="test__pingserver_8cc_source.html">test_pingserver.cc</a></li>
<li><a class="el" href="test__pingclient_8cc_source.html">test_pingclient.cc</a></li>
</ul>
<h2>Temperature Server </h2>
<ul>
<li><a class="el" href="data__generator_8h_source.html">data_generator.h</a></li>
<li><a class="el" href="server__process_8h_source.html">server_process.h</a></li>
<li><a class="el" href="client__process_8h_source.html">client_process.h</a></li>
<li><a class="el" href="test__server_8cc_source.html">test_server.cc</a></li>
<li><a class="el" href="test__client_8cc_source.html">test_client.cc</a></li>
</ul>
<h1>File structure: </h1>
<ul>
<li>src<ul>
<li><a class="el" href="channel_8cc_source.html">channel.cc</a></li>
<li><a class="el" href="client_8cc_source.html">client.cc</a></li>
<li><a class="el" href="manager_8cc_source.html">manager.cc</a></li>
<li><a class="el" href="process_8cc_source.html">process.cc</a></li>
<li><a class="el" href="state__machine_8cc_source.html">state_machine.cc</a></li>
<li><a class="el" href="state_8cc_source.html">state.cc</a></li>
<li><a class="el" href="tcp__client_8cc_source.html">tcp_client.cc</a></li>
<li><a class="el" href="tcp__server_8cc_source.html">tcp_server.cc</a></li>
</ul>
</li>
<li>include<ul>
<li><a class="el" href="channel_8h_source.html">channel.h</a></li>
<li><a class="el" href="client_8h_source.html">client.h</a></li>
<li><a class="el" href="client__ping_8h_source.html">client_ping.h</a></li>
<li><a class="el" href="client__process_8h_source.html">client_process.h</a></li>
<li><a class="el" href="data__generator_8h_source.html">data_generator.h</a></li>
<li><a class="el" href="elma_8h_source.html">elma.h</a></li>
<li><a class="el" href="event_8h_source.html">event.h</a></li>
<li><a class="el" href="exceptions_8h_source.html">exceptions.h</a></li>
<li><a class="el" href="literals_8h.html">literals.h</a></li>
<li><a class="el" href="manager_8h_source.html">manager.h</a></li>
<li><a class="el" href="process_8h_source.html">process.h</a></li>
<li><a class="el" href="server__ping_8h_source.html">server_ping.h</a></li>
<li><a class="el" href="server__process_8h_source.html">server_process.h</a></li>
<li><a class="el" href="state_8h_source.html">state.h</a></li>
<li><a class="el" href="state__machine_8h_source.html">state_machine.h</a></li>
<li><a class="el" href="tcp__client_8h_source.html">tcp_client.h</a></li>
<li><a class="el" href="tcp__server_8h_source.html">tcp_server.h</a></li>
<li><a class="el" href="transition_8h_source.html">transition.h</a></li>
</ul>
</li>
<li>examples<ul>
<li>Makefile</li>
<li><a class="el" href="test__client_8cc_source.html">test_client.cc</a></li>
<li><a class="el" href="test__pingclient_8cc_source.html">test_pingclient.cc</a></li>
<li><a class="el" href="test__pingserver_8cc_source.html">test_pingserver.cc</a></li>
<li><a class="el" href="test__server_8cc_source.html">test_server.cc</a></li>
</ul>
</li>
</ul>
<h1>Results </h1>
<ul>
<li>Simple Client Server ping<ul>
<li>Please find the print statements of messages from client and server side.</li>
<li>Client pings server with "Hello"</li>
<li>Server responds with current date and time.</li>
</ul>
</li>
<li>Temperature Server<ul>
<li>Please find the print statements of messages from client and server side.</li>
<li>The length of the data sent from client is tested against the message received by server.</li>
<li>Also, the number of updates of server process is tested against the number of acknowledgements sent by server to client.</li>
</ul>
</li>
</ul>
<h1>Acknowledgements </h1>
<p>A great thanks to the following people!</p>
<ul>
<li>Prof.Klavins - He was of a great help for giving me ideas about how to integrate TCP/IP into Elma. He also advised me how to write a gtest for this case.</li>
<li>Justin Vrana - Gave me the idea about showing print statements from server and client side to show confirmation, in case test case couldn't be written.</li>
<li>Kung-Hung(Henry)Lu - Helped me with the file structure and make file for server client applications.</li>
</ul>
<h1>References </h1>
<h2>Libraries </h2>
<ul>
<li>Elma</li>
<li>C socket libraries<ul>
<li>sys/types.h</li>
<li>sys/socket.h</li>
<li>netdb.h</li>
<li>netinet/in.h <h2>Links </h2>
</li>
</ul>
</li>
<li><a href="https://www.geeksforgeeks.org/socket-programming-cc/">https://www.geeksforgeeks.org/socket-programming-cc/</a> <h2>Books </h2>
</li>
</ul>
<ul>
<li>Exploring Raspberry PI by Derek Molly </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
  <hr class="footer"/><address class="footer"><small>
  Developed by <a href="http://klavinslab.org">Eric Klavins</a> for UW ECE P 520<br>
  Generated on Fri Mar 22 2019 22:57:13 for Elma by &#160;<a href="http://www.doxygen.org/index.html">
  Doxygen
  </a> 1.8.8
  </small></address>
  </body>
  </html>